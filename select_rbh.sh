#!/bin/bash -ve
#

### for RBH4 ###
# for 90%
cd RBH90 
grep -f rbh_congruent.txt RBH4_aa_output | awk '{ if ($6 < 90 && $8 < 90 && $10 < 90 && $12 < 90 && $14 < 90 && $16 < 90 && $7 < 1.05*$13 && $7 > 0.95*$13 && $9 < 1.05*$13 && $9 > 0.95*$13 && $11 < 1.05*$13 && $11 > 0.95*$13 && $15 < 1.05*$13 && $15 > 0.95*$13 && $17 < 1.05*$13 && $17 > 0.95*$13) print }' > ../rbh90_con.txt

# for 95%
cd ../RBH95
grep -f rbh_congruent.txt RBH4_aa_output | awk '{ if ($12 > 90 && $6 < 95 && $8 < 95 && $10 < 95 && $12 < 95 && $14 < 95 && $16 < 95 && $7 < 1.05*$13 && $7 > 0.95*$13 && $9 < 1.05*$13 && $9 > 0.95*$13 && $11 < 1.05*$13 && $11 > 0.95*$13 && $15 < 1.05*$13 && $15 > 0.95*$13 && $17 < 1.05*$13 && $17 > 0.95*$13) print }' > ../rbh95_con.txt

# for 97%
cd ../RBH97
grep -f rbh_congruent.txt RBH4_aa_output | awk '{ if ($12 > 95 && $6 < 97 && $8 < 97 && $10 < 97 && $12 < 97 && $14 < 97 && $16 < 97 && $7 < 1.05*$13 && $7 > 0.95*$13 && $9 < 1.05*$13 && $9 > 0.95*$13 && $11 < 1.05*$13 && $11 > 0.95*$13 && $15 < 1.05*$13 && $15 > 0.95*$13 && $17 < 1.05*$13 && $17 > 0.95*$13) print }' > ../rbh97_con.txt

# for 99%
cd ../RBH99
grep -f rbh_congruent.txt RBH4_aa_output | awk '{ if ($12 > 97 && $6 < 99 && $8 < 99 && $10 < 99 && $12 < 99 && $14 < 99 && $16 < 99 && $7 < 1.05*$13 && $7 > 0.95*$13 && $9 < 1.05*$13 && $9 > 0.95*$13 && $11 < 1.05*$13 && $11 > 0.95*$13 && $15 < 1.05*$13 && $15 > 0.95*$13 && $17 < 1.05*$13 && $17 > 0.95*$13) print }' > ../rbh99_con.txt 

cd ..
cat *_con.txt > RBH4allcon.txt

### for RBH3 ###
# for 90%
cd RBH90
awk '{ if ($5 < 90 && $7 < 90 && $9 < 90 && $8 < 1.05*$6 && $8 > 0.95*$6 && $10 < 1.05*$6 && $10 > 0.95*$6) print }' RBH3_aa_output > ../rbh3_90.txt

# for 95%
cd ../RBH95
awk '{ if ($5 > 90 && $5 < 95 && $7 < 95 && $9 < 95 && $8 < 1.05*$6 && $8 > 0.95*$6 && $10 < 1.05*$6 && $10 > 0.95*$6) print }' RBH3_aa_output > ../rbh3_95.txt

# for 97%
cd ../RBH97
awk '{ if ($5 > 95 && $5 < 97 && $7 < 97 && $9 < 97 && $8 < 1.05*$6 && $8 > 0.95*$6 && $10 < 1.05*$6 && $10 > 0.95*$6) print }' RBH3_aa_output > ../rbh3_97.txt

# for 99%
cd ../RBH99
awk '{ if ($5 > 97 && $5 < 99 && $7 < 99 && $9 < 99 && $8 < 1.05*$6 && $8 > 0.95*$6 && $10 < 1.05*$6 && $10 > 0.95*$6) print }' RBH3_aa_output > ../rbh3_99.txt

cd ..
cat rbh3_* > RBH3all.txt


